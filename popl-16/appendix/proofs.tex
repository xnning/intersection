% \section{Proofs}
%
% \paragraph{Notation.} We sketch most of our proofs in two-column style: on the
% left are the intermediate results and on the right are the justification (for
% the previous intermediate result to reach the corresponding left-hand side).
%
% % \subsection{Subtyping}
%
% % \begin{theorem}[Subtyping is reflexive]
% %   If $A$ is a well-formed type, then $A \subtype A$.
% % \end{theorem}
%
% % \begin{proof}
% %   \george{TODO}
% % \end{proof}
%
% % \begin{theorem}[Subtyping is transitive]
% %   If $A_1$, $A_2$, $A_3$ are well-formed types, and
% %   $A_1 \subtype A_2$ and $A_2 \subtype A_3$, then
% %   $A_1 \subtype A_3$.
% % \end{theorem}
%
% % \begin{proof}
% %   \george{TODO}
% % \end{proof}
%
% % \bruno{fix numbering of lemmas}
% % \bruno{reflexitivity and transitivity missing. You can do a proof
% %   sketch instead of a full proof. Just say in 1 or 2 sentences what is
% % the main idea. You can mention that we have a full proof in Coq.}
% % \bruno{target type system is missing 3 cases: Tunit; Tproj1; TProj2}
%
% % \subsection{Elaboration}
%
% \lemmasub*
% \begin{proof}
%   By structural induction of the derivation.
%
%   \begin{itemize}
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \rulesubvar &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ \hastype {\epsilon} {\lam x {\im \alpha} x} {\alpha \to \alpha} $ & By $ \rulelabeltargetvar $ and $ \rulelabeltargetlam $
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \rulesubTop &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ \hastype {\epsilon} {\lam x {\im A} ()} {\im A \to ()} $ & By $ \rulelabeltargetvar $ and $ \rulelabeltargetlam $ \\
%       & $ \hastype {\epsilon} {\lam x {\im A} ()} {\im A \to \im \top} $ & By the definition of $ \im \cdot $
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \rulesubfun &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ \hastype \epsilon {C_1} {\im {A_3} \to \im {A_1}} $ & By i.h. \\
%       & $ \hastype \epsilon {C_2} {\im {A_2} \to \im {A_4}} $ & By i.h. \\
%       & $ \hastype {\epsilon, x \hast {\im {A_3}}} x {\im {A_3}} $ & By $\rulelabeltargetvar$ \\
%       & $ A_3 \subtype A_1 \yields {C_1} $ & Premise \\
%       & $ \hastype {\epsilon, x \hast {\im {A_3}}} {\app {C_1} x} {\im {A_1}} $ & By $\rulelabeltargetApp$ \\
%       & $ \hastype {\epsilon, f \hast {\im {A_1 \to A_2}}} f {\im {A_1 \to A_2}} $ & By $\rulelabeltargetvar$ \\
%       & $ \hastype {\epsilon, f \hast {\im {A_1 \to A_2}}} f {\im {A_1} \to \im {A_2}} $ & By the definition of $ \im \cdot $ \\
%       & $ \hastype {\epsilon, f \hast {\im {A_1 \to A_2}}, x \hast {\im {A_3}}} {\app f {(\app {C_1} x})} {\im {A_2}} $ & By $\rulelabeltargetApp$ \\
%       & $ \hastype {\epsilon, f \hast {\im {A_1 \to A_2}}, x \hast {\im {A_3}}} {\app {C_2} {(\app f {(\app {C_1} x})})} {\im {A_4}} $ & By $\rulelabeltargetApp$ \\
%       & $ \hastype \epsilon {\lam f {\im {A_1 \to A_2}} {\lam x {\im {A_3}} {\app {C_2} {(\app f {(\app {C_1} x)})}}}} {\im {A_1 \to A_2} \to \im {A_3} \to \im {A_4}} $ & By applying $\rulelabeltargetlam$ twice \\
%       & $ \hastype \epsilon {\lam f {\im {A_1 \to A_2}} {\lam x {\im {A_3}} {\app {C_2} {(\app f {(\app {C_1} x)})}}}} {\im {A_1 \to A_2} \to \im {A_3 \to A_4}} $ & By the definition of $\im \cdot$
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \rulesubforall &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ \hastype \epsilon C {\im {A_1} \to {\im {\subst {\alpha_1} {\alpha_2} A_2}}} $ & By i.h. \\
%       & $ \hastype {\epsilon, f \hast {\im {\for {\alpha_1} {A_1}}}} f {\im {\for {\alpha_1} {A_1}}} $ & By $\rulelabeltargetvar$ \\
%       & $ \hastype {\epsilon, f \hast {\im {\for {\alpha_1} {A_1}}}} f {\for {\alpha_1} {\im {A_1}}} $ & By the definition of $ \im \cdot $ \\
%       & $ \hastype {\epsilon, f \hast {\im {\for {\alpha_1} {A_1}}}, \alpha} {\tapp f \alpha} {\subst \alpha {\alpha_1} {\im {A_1}}} $ & By $\rulelabeltargetvar$ and $\rulelabeltargetTApp$ \\
%       & $ \hastype {\epsilon, f \hast {\im {\for {\alpha_1} {A_1}}}, \alpha} {\app C {(\tapp f \alpha)}} {\subst \alpha {\alpha_1} {\im {\subst {\alpha_1} {\alpha_2} {A_2}}}} $ & By $\rulelabeltargetApp$ \\
%       & $ \hastype {\epsilon, f \hast {\im {\for {\alpha_1} {A_1}}}} {\blam \alpha {\app C {(\tapp f \alpha)}}} {\for {\alpha_2} {\im {A_2}}} $ & By $\rulelabeltargetBLam$ and substitution \george{Substitution is problematic} \\
%       & $ \hastype \epsilon {\lam f {\im {\for {\alpha_1} {A_1}}} {\blam \alpha {\app C {(\tapp f \alpha)}}}} {\im {\for {\alpha_1} {A_1}} \to \for {\alpha_2} {\im {A_2}}} $ & By $\rulelabeltargetlam$ \\
%       & $ \hastype \epsilon {\lam f {\im {\for {\alpha_1} {A_1}}} {\blam \alpha {\app C {(\tapp f \alpha)}}}} {\im {\for {\alpha_1} {A_1}} \to \im {\for {\alpha_2} {A_2}}} $ & By the definition of $\im \cdot$
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \rulesubinter &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $\hastype {\epsilon, x \hast \im {A_1}} x {\im {A_1}}$ & By $\rulelabeltargetvar$ \\
%       & $\hastype \epsilon {C_1} {\im {A_1} \to \im {A_2}}$ & By i.h. \\
%       & $\hastype {\epsilon, x \hast \im {A_1}} {\app {C_1} x} {\im {A_2}}$ & By $\rulelabeltargetApp$ and weakening \\
%       & $\hastype {\epsilon, x \hast \im {A_1}} {\app {C_2} x} {\im {A_3}}$ & Similar \\
%       & $\hastype {\epsilon, x \hast \im {A_1}} {\pair {\app {C_1} x} {\app {C_2} x}} {\pair {\im {A_2}} {\im {A_3}}}$ & By $\rulelabeltargetPair$ \\
%       & $\hastype {\epsilon, x \hast \im {A_1}} {\pair {\app {C_1} x} {\app {C_2} x}} {\im {A_2 \inter A_3}}$ & By the definition of $\im \cdot$ \\
%       & $\hastype \epsilon {\lam x {\im {A_1}} {\pair {\app {C_1} x} {\app {C_2} x}}} {\im {A_1} \to {\im {A_2 \inter A_3}}}$ & By $\rulelabeltargetlam$
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \rulesubinterleft &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ \hastype {\epsilon, x \hast \im {A_1 \inter A_2}} x {\im {A_1 \inter A_2}} $ & By $\rulelabeltargetvar$ \\
%       & $ \hastype {\epsilon, x \hast \im {A_1 \inter A_2}} x {\pair {\im {A_1}} {\im {A_2}}} $ & By the definition of $\im \cdot$ \\
%       & $ \hastype {\epsilon, x \hast \im {A_1 \inter A_2}} {\proj 1 x} {\im {A_1}} $ & By $\rulelabeltargetprojl$ \\
%       & $ \hastype \epsilon C {\im {A_1} \to \im {A_3}} $ & By i.h. \\
%       & $ \hastype {\epsilon, x \hast \im {A_1 \inter A_2}} C {\im {A_1} \to \im {A_3}} $ & By weakening \\
%       & $ \hastype {\epsilon, x \hast \im {A_1 \inter A_2}} {\app C {(\proj 1 x)}} {\im {A_3}} $ & By $\rulelabeltargetApp$ \\
%       & $ \hastype \epsilon {\lam x {\im {A_1 \inter A_2}} {\app C {(\proj 1 x)}}} {\im {A_1 \inter A_2} \to \im {A_3}} $ & By $\rulelabeltargetlam$
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \rulesubinterright &
%     \end{flalign*}
%
%     By symmetry with the above case. \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \rulesubRec &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ A_1 \subtype A_2 \yields C $ & Premise \\
%       & $ \hastype \epsilon C {\im {A_1} \to \im {A_2}} $ & By i.h. \\
%       & $ \hastype {\epsilon, x \hast \im {\recordType l {A_1}}} x {\im {\recordType l {A_1}}} $ & By $ \rulelabeltargetvar $ \\
%       & $ \hastype {\epsilon, x \hast \im {\recordType l {A_1}}} x {\im {A_1}} $ & By the definition of $ \im \cdot $ \\
%       & $ \hastype {\epsilon, x \hast \im {\recordType l {A_1}}} {\app C x} {\im {A_2}} $ & By $ \rulelabeltargetApp $ \\
%       & $ \hastype {\epsilon, x \hast \im {\recordType l {A_1}}} {\app C x} {\im {\recordType l {A_2}}} $ & By the definition of $ \im \cdot $ \\
%       & $ \hastype \epsilon {\lam x {\im {\recordType l {A_1}}} {\app C x}} {\im {\recordType l {A_1}} \to \im {\recordType l {A_2}}} $ & By $ \rulelabeltargetlam $
%     \end{tabular} \\
%
%   \end{itemize}
%
% \end{proof}
%
% \lemmaselect*
% \begin{proof}
%   By structural induction of the derivation.
%
%   \begin{itemize}
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \ruleGetElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ \hastype \epsilon {\lam x {\im {\recordType l A}} x} {\im {\recordType l A} \to \im {\recordType l A}} $ & By $ \rulelabeltargetlam $ and $\rulelabeltargetvar$ \\
%       & $ \hastype \epsilon {\lam x {\im {\recordType l A}} x} {\im {\recordType l A} \to \im A} $ & By the definition of $ \im \cdot $
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \ruleGetLeftElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ \hastype {\epsilon, x \hast \im {A_1 \inter A_2}} x {\im {A_1 \inter A_2}} $ & By $ \rulelabeltargetvar $ \\
%       & $ \hastype {\epsilon, x \hast \im {A_1 \inter A_2}} x {\pair {\im {A_1}} {\im {A_2}}} $ & By the definition of $\im \cdot$ \\
%       & $ \hastype {\epsilon, x \hast \im {A_1 \inter A_2}} {\proj 1 x} {\im {A_1}} $ & By $\rulelabeltargetprojl$ \\
%       & $ \hastype \epsilon C {\im {A_1} \to \im A} $ & By i.h. \\
%       & $ \hastype {\epsilon, x \hast \im {A_1 \inter A_2}} C {\im {A_1} \to \im A} $ & By weakening \\
%       & $ \hastype {\epsilon, x \hast \im {A_1 \inter A_2}} {\app C {(\proj 1 x)}} {\im A} $ & By $\rulelabeltargetApp$ \\
%       & $ \hastype \epsilon {\lam x {\im {A_1 \inter A_2}} {\app C {(\proj 1 x)}}} {\im {A_1 \inter A_2} \to \im A} $ & By $ \rulelabeltargetlam $
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \ruleGetRightElab &
%     \end{flalign*}
%
%     By symmetry with the above case. \\
%
% \end{itemize}
% \end{proof}
%
%
% \lemmarestrict*
% \begin{proof}
%   By structural induction of the derivation.
%
%   \begin{itemize}
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \ruleRestrictElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ \hastype \epsilon {\lam x {\im {\recordType l A}} {()}} {\im {\recordType l A} \to ()} $ & By $\rulelabeltargetUnit$ and $\rulelabeltargetlam$ \\
%       & $ \hastype \epsilon {\lam x {\im {\recordType l A}} {()}} {\im {\recordType l A} \to \im \top} $ & By the definition of $\im \cdot$
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \ruleRestrictLeftElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $\judgeRestrict {A_1} l A \yields C$ & Premise \\
%       & $\hastype \epsilon C {\im {A_1} \to \im A} $ & By i.h. \\
%       & $\hastype {\epsilon, x \hast \im {A_1 \inter A_2}} x {\im {A_1 \inter A_2}} $ & By $\rulelabeltargetvar$ \\
%       & $\hastype {\epsilon, x \hast \im {A_1 \inter A_2}} x {\pair {\im {A_1}} {\im {A_2}}} $ & By the definition of $\im \cdot$ \\
%       & $\hastype {\epsilon, x \hast \im {A_1 \inter A_2}} {\proj 1 x} {\im {A_1}} $ & By $\rulelabeltargetprojl$ \\
%       & $\hastype {\epsilon, x \hast \im {A_1 \inter A_2}} {\proj 2 x} {\im {A_2}} $ & By $\rulelabeltargetprojr$ \\
%       & $\hastype {\epsilon, x \hast \im {A_1 \inter A_2}} {\app C {(\proj 1 x)}} {\im {A}} $ & By $\rulelabeltargetApp$ \\
%       & $\hastype {\epsilon, x \hast \im {A_1 \inter A_2}} {\pair {\app C {(\proj 1 x)}} {\proj 2 x}} {\pair {\im {A}} {\im {A_2}}} $ & By $\rulelabeltargetPair$ \\
%       & $\hastype {\epsilon, x \hast \im {A_1 \inter A_2}} {\pair {\app C {(\proj 1 x)}} {\proj 2 x}} {\im {A \inter A_2}} $ & By the definition of $\im \cdot$ \\
%       & $\hastype \epsilon {\lam x {\im {A_1
%           \inter A_2}} {\pair {\app C {(\proj 1 x)}} {\proj 2 x}}} {\im {A_1 \inter A_2} \to \im {A \inter A_2}} $ & By $\rulelabeltargetlam$
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \ruleRestrictRightElab &
%     \end{flalign*}
%
%     By symmetry with the above case. \\
%
% \end{itemize}
% \end{proof}
%
% \begin{comment}
% \begin{lemma}[\rulelabelUpdate~rules produce type-correct coercion] \label{lemma:update-correct}
%   If $ \judgeUpdate A l {A_1 \yields E} {A_2} {A_3} \yields C $ and $
%   \hastype \Gamma E {\im {A_1}} $ for some $ \Gamma $, then
%   $ \hastype \Gamma C {\im A \to \im {A_2}} $.
% \end{lemma}
%
% \begin{proof}
%   By structural induction of the derivation.
%
%   \begin{itemize}
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \ruleUpdateElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ \hastype \Gamma {\lam \_ {\im {\recordType l A}} E} {\im {\recordType l A}} \to \im {A_1} $ & By $ \rulelabeltargetlam $, $ \rulelabeltargetvar $, and the hypothesis
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \ruleUpdateLeftElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ \hastype {\Gamma, x \hast \im {A_1 \inter A_2}} x {\im {A_1 \inter A_2}} $ & By $\rulelabeltargetvar$ \\
%       & $ \hastype {\Gamma, x \hast \im {A_1 \inter A_2}} x {\pair {\im {A_1}} {\im {A_2}}} $ & By the definition of $\im \cdot$ \\
%       & $ \hastype {\Gamma, x \hast \im {A_1 \inter A_2}} {\proj 1 x} {\im {A_1}} $ & By $\rulelabeltargetprojl$ \\
%       & $ \hastype \Gamma C {\im {A_1} \to \im {A_3}} $ & By i.h. \\
%       & $ \hastype {\Gamma, x \hast \im {A_1 \inter A_2}} C {{\im {A_1}} \to \im {A_3}} $ & By weakening \\
%       & $ \hastype {\Gamma, x \hast \im {A_1 \inter A_2}} {\app C {(\proj 1 x)}} {\im {A_3}} $ & By $\rulelabeltargetApp$ \\
%       & $ \hastype \Gamma {\lam x {\im {A_1 \inter A_2}} {\app C {(\proj 1 x)}}} {\im {A_1 \inter A_2} \to \im {A_3}} $ & By $\rulelabeltargetlam$
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \ruleUpdateRightElab &
%     \end{flalign*}
%
%     By symmetry with the above case. \\
%
%   \end{itemize}
% \end{proof}
% \end{comment}
%
% \begin{lemma}[Preservation of well-formedness under type translation] \label{lemma:preserve-wf}
%   If $ \istype \gamma A $, then $ \istype {\im \gamma} {\im A} $.
% \end{lemma}
%
% \begin{proof}
%   By structural induction of the derivation. The only case to consider is $ \rulelabelWF $.
%
%   \begin{itemize}
%
%   \item \textbf{Case}
%
%     \begin{flalign*}
%       & \ruleWF &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ \ftv A \in \gamma $ & Premise \\
%       & $ \ftv {\im A} \in \im \gamma $ & By the definition of $ \im \cdot $ \\
%       & $ \istype {\im \gamma} {\im A} $ & By $ \rulelabeltargetWF $
%     \end{tabular} \\
%
%   \end{itemize}
% \end{proof}
%
% \theorempreservation*
% \begin{proof}
%   By structural induction of the derivation.
%
%   \begin{itemize}
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \tyvarElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%      & $ (x,A) \in \gamma $ & Premise \\
%      & $ (x,\im A) \in \im \gamma $ & By the definition of $ \im \cdot $ \\
%      & $ \hastype {\im \gamma} x {\im A} $ & By $ \rulelabeltargetvar $
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \ruleTopElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $\hastype {\im \gamma} {()} {()} $ & By $\rulelabeltargetUnit$ \\
%       & $\hastype {\im \gamma} {()} {\im \top}$ & By the definition of $ \im \cdot$
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \tylamElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ \hastype {\gamma, x \hast A} e {A_1} \yields E $ & Premise \\
%       & $ \hastype {\im {\gamma, x \hast A}} E {\im {A_1}} $ & By i.h. \\
%       & $ \hastype {\im \gamma, x \hast \im A} E {\im {A_1}} $ & By the definition of $ \im \cdot $ \\
%       & $ \hastype {\im \gamma} {\lam x {\im A} E} {\im A \to \im {A_1}} $ & By $ \rulelabeltargetlam $ \\
%       & $ \hastype {\im \gamma} {\lam x {\im A} E} {\im {A \to A_1}} $ & By the definition of $ \im \cdot $
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \tyappElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%      & $ \hastype \gamma {e_1} {A_1 \to A_2} \yields {E_1} $  & Premise \\
%      & $ \hastype {\im \gamma} {E_1} {\im {A_1 \to A_2}} $ & By i.h. \\
%      & $ \hastype \gamma {e_2} {A_3} \yields {E_2} $ & Premise \\
%      & $ \hastype {\im \gamma} {E_2} {\im {A_3}} $ & By i.h. \\
%      & $ A_3 \subtype A_1 \yields C $ & Premise \\
%      & $ \hastype \epsilon C {\im {A_3} \to \im {A_1}} $ & By Lemma~\ref{lemma:sub} \\
%      & $ \hastype {\im \gamma} {\app {E_1} {(\app C E_2)}} {\im {A_2}} $ & By $ \rulelabeltargetApp $ and the definition of $ \im \cdot $
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \tyblamElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ \hastype {\gamma, \alpha} e A \yields E $ & Premise \\
%       & $ \hastype {\im {\gamma, \alpha}} E {\im A} $ & By i.h. \\
%       & $ \hastype {\im \gamma, \alpha} E {\im A} $ & By the definition of $ \im \cdot $ \\
%       & $ \hastype {\im \gamma} {\blam \alpha E} {\for \alpha {\im A}} $ & By $ \rulelabeltargetBLam $ \\
%       & $ \hastype {\im \gamma} {\blam \alpha E} {\im {\for \alpha A}} $ & By the definition of $ \im \cdot $
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \tytappElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%      & $ \hastype \gamma e {\for \alpha A_1} \yields E $ & Premise \\
%      & $ \hastype {\im \gamma} E {\im {\for \alpha A_1}} $ & By i.h. \\
%      & $ \hastype {\im \gamma} E {\for \alpha \im {A_1}} $ & By the definition of $ \im \cdot $ \\
%      & $ \istype \gamma A $ & Premise \\
%      & $ \istype {\im \gamma} {\im A} $ & By Lemma~\ref{lemma:preserve-wf} \\
%      & $ \hastype \gamma {\tapp E {\im A}} {\subst {\im A} \alpha {\im {A_1}}} $ & By $ \rulelabeltargetTApp $ \\
%      & $ \hastype \gamma {\tapp E {\im A}} {\im {\subst A \alpha {A_1}}} $ & By substitution lemma
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \tymergeElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ \hastype \gamma {e_1} {A_1} \yields {E_1} $ & Premise \\
%       & $ \hastype {\im \gamma} {E_1} {\im {A_1}} $ & By i.h. \\
%       & $ \hastype {\im \gamma} {E_2} {\im {A_2}} $ & Similar to the above \\
%       & $ \hastype {\im \gamma} {\pair {E_1} {E_2}} {\pair {\im {A_1}} {\im {A_2}}} $ & By $ \rulelabeltargetPair $ \\
%       & $ \hastype {\im \gamma} {\pair {E_1} {E_2}} {\im {A_1 \inter A_2}} $ & By the definition of $ \im \cdot $
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \rulerecordConstructElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%       & $ \hastype \gamma e A \yields E $ & Premise \\
%       & $ \hastype {\im \gamma} E {\im A} $ & By i.h. \\
%       & $ \hastype {\im \gamma} E {\im {\recordType l A}} $ & By the definition of $ \im \cdot $
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \ruleRecSelectElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%      & $ \judgeSelect A l {A_1} \yields C $ & Premise \\
%      & $ \hastype \epsilon C {\im A \to \im {A_1}} $ & By Lemma~\ref{lemma:select} \\
%      & $ \hastype {\im \gamma} C {\im A \to \im {A_1}} $ & By weakening \\
%      & $ \hastype \gamma e A \yields E $ & Premise \\
%      & $ \hastype {\im \gamma} E {\im A} $ & By i.h. \\
%      & $ \hastype {\im \gamma} {\app C E} {\im {A_1}} $ & By $ \rulelabeltargetApp $
%     \end{tabular} \\
%
%   \item \textbf{Case}
%     \begin{flalign*}
%       & \ruleRecRestrictElab &
%     \end{flalign*}
%
%     \begin{tabular}{rll}
%      & $ \judgeRestrict A l {A_1} \yields C $ & Premise \\
%      & $ \hastype \epsilon C {\im A \to \im {A_1}} $ & By Lemma~\ref{lemma:restrict} \\
%      & $ \hastype {\im \gamma} C {\im A \to \im {A_1}} $ & By weakening \\
%      & $ \hastype \gamma e A \yields E $ & Premise \\
%      & $ \hastype {\im \gamma} E {\im A} $ & By i.h. \\
%      & $ \hastype {\im \gamma} {\app C E} {\im {A_1}} $ & By $ \rulelabeltargetApp $
%     \end{tabular} \\
%
%   % \item \textbf{Case}
%   %   \begin{flalign*}
%   %     & \rulerecordUpdateelab &
%   %   \end{flalign*}
%
%   %   \begin{tabular}{rll}
%   %     & $ \hastype \gamma {e_1} {A_1} \yields {E_1} $ & Premise \\
%   %     & $ \hastype {\im \gamma} {E_1} {\im {A_1}} $ & By i.h. \\
%   %     & $ \judgeUpdate A l {A_1 \yields {E_1}} {A_2} {A_3} \yields C $ & Premise \\
%   %     & $ \hastype {\im \gamma} C {\im A \to \im {A_2}} $ & By Lemma~\ref{lemma:update-correct} \\
%   %     & $ \hastype \gamma e A \yields E $ & Premise \\
%   %     & $ \hastype {\im \gamma} E {\im A} $ & By i.h. \\
%   %     & $ \hastype {\im \gamma} {\app C E} {\im {A_2}} $ & By $ \rulelabeltargetApp $
%   %   \end{tabular} \\
%
%   \end{itemize}
% \end{proof}
