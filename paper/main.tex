\documentclass[twocolumn]{article}

% Remote packages %
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{color}
\usepackage{fixltx2e}
\usepackage{mdframed}
\usepackage{xcolor}

\newmdtheoremenv{theorem}{Theorem}
\newmdtheoremenv{lemma}{Lemma}

\definecolor{github}{HTML}{4183C4}

\input{macros/type_systems.tex}
\input{macros/systemfi.tex}

\begin{document}

\title{SystemFI: A Core Language for Delegation-based Programming}
\maketitle

\begin{abstract}
  This paper ...
\end{abstract}

\section{Introduction}

Intersection types are useful for functional programming. In particular for 
extensibility and allowing new forms of composition. 

We show a polymorphic language with intersection types and records, and 
how this language can be used to solve various common tasks in functional
programming in a nicer way.

We have a formalization + implementation + proofs.  

Prototype-based programming is one of the two major styles of object-oriented programming, the other being class-based programming which is featured in languages such as Java and C\#.
It has gained
increasing popularity recently with the prominence of JavaScript in
web applications. Prototype-based programming supports highly dynamic
behaviors at run time that are not possible with traditional
class-based programming. However, despite its flexibility,
prototype-based programming is often criticized over concerns of
correctness and safety. Furthermore, almost all prototype-based
systems rely on the fact that the language is dynamically typed and
interpreted.


This paper introduces System $F_{IR}$

Inheritance based

\section{Overview}

There should be a section informally describing the language (System FI) 
through various examples.

Mention properties informally via examples:

%f : A & A -> A
%f x = x

\subsection{Algebras}

\subsection{Lenses}

\subsection{Embedded DSLs} 

\section{System FI}

Syntax + Type System 

Talk about properties of the languages 
(commutativity of intersection types, ...)

\section{Type-Directed Translation to System F}

Type-Directed Translation to System F. 
Main results: type-preservation + coherence. 

\section{Implementation}

Talk about the implementation + extensions not in the formalization. 

\section{Case Study?}

\section{Properties}

Commutative
$ A \wedge B = B \wedge A $

$ A = A \wedge A $

Idempotent

Source subtyping

Exclusion of $0$-ary intersection => dynamic typing

subtyping of the arrow

Algebra's \& mixins
lenses

\section{Case Studies}

\section{Related work}

Write a paragraph.

Dunfield: no records
The idea of encoding records using intersection types is due to ... Reynolds and Castagna. The issue of coherence. Make a note about how part of this problem is mitigated.

Nystrom et. al. OOPSLA 06


Applications:

- Object/Fold Algebras. How to support extensibility in an easier way. 

See Datatypes a la Carte

- Mixins

- Lenses? Can intersection types help with lenses? Perhaps making the 
types more natural and easy to understand/use?

- Embedded DSLs? Extensibility in DSLs? Composing multiple DSL interpretations?

http://www.cs.ox.ac.uk/jeremy.gibbons/publications/embedding.pdf

\framebox{$|\tau| = T$}

\[
\begin{array}{rcl}
  |\alpha|               & = & \alpha \\
  |\tau_1 \to \tau_2|    & = & |\tau_1| \to |\tau_2| \\
  |\forall \alpha. \tau| & = & \forall \alpha. |\tau| \\
  |t_1 \& t_2|           & = & \langle |\tau_1|, |\tau_2| \rangle \\
  |\{ l : \tau \}|       & = & |\tau|
\end{array}
\]

\begin{lemma} \label{type-coerce}
  If $$ \Gamma \vdash \tau_1 <: \tau_2 \yields{C} $$
  then $$ |\Gamma| \vdash C : |\tau_1| \to |\tau_2| $$
\end{lemma}

\begin{proof}
By structural induction on the types and the corresponding inference rule. \\

\texttt{(SubVar)}

\texttt{(SubFun)}

\texttt{(SubForall)}

\texttt{(SubAnd1)}

\texttt{(SubAnd2)}

\texttt{(SubAnd3)}

\texttt{(SubRcd)}

\end{proof}

\begin{lemma} \label{type-get}
  If $$ \Gamma \vdash_{get} \tau ; l = C ; \tau_1 $$
  then $$ |\Gamma| \vdash C : |\tau| \to |\tau_1| $$
\end{lemma}

\begin{proof}
By structural induction on the type and the corresponding inference rule. \\

\texttt{(Get-Base)} $ \Gamma \vdash_{get} \{ l : \tau \} ; l = \lambda (x : |\{ l : \tau \}|). x ; \tau $ \\

By the induction hypothesis
$$ |\Gamma| \vdash \lambda (x : |\{ l : \tau \}|). x : |\{ l : \tau \}| \to |\tau| $$

\texttt{(Get-Left)} \\
\texttt{(Get-Right)} \\

\end{proof}

\begin{lemma} \label{type-put}
  If $$ \Gamma \vdash_{put} \tau ; l ; E = C ; \tau_1 $$
  then $$ |\Gamma| \vdash C : |\tau| \to |\tau| $$
\end{lemma}

\begin{proof}
By structural induction on the type and the corresponding inference rule. \\

\texttt{(Put-Base)} \\
\texttt{(Put-Left)} \\
\texttt{(Put-Right)} \\
\end{proof}

\begin{lemma} \label{preserve-wf}
  If   $$ \Gamma \vdash \tau $$
  then $$ |\Gamma| \vdash |\tau| $$
\end{lemma}

\begin{proof}
Since $$ \Gamma \vdash \tau $$
It follows from \texttt{(FI-WF)} that
  $$ \ftv{\tau} \subseteq \ftv{\Gamma} $$
And hence
  $$ \ftv{|\tau|} \subseteq \ftv{|\Gamma|} $$
By \texttt{(F-WF)} we have
  $$ \Gamma \vdash \tau $$
\end{proof}

\begin{theorem}[Type preserving translation] \label{preserve-tr}
  If   $$ \Gamma \vdash e : \tau \yields{E} $$
  then $$ |\Gamma| \vdash E : \left| \tau \right| $$
\end{theorem}

\begin{proof}
By structural induction on the expression and the corresponding inference rule. \\

\texttt{(TrVar)} $ \Gamma \vdash x : \tau \yields{x} $ \\

It follows from \texttt{(TrVar)} that
  $$ (x : \tau) \in \Gamma $$
Based on the definition of $ |\cdot| $,
  $$ (x : |\tau|) \in |\Gamma| $$
Thus we have by \texttt{(F-Var)} that
  $$ |\Gamma| \vdash x : |\tau| $$

\texttt{(TrAbs)} $ \Gamma \vdash \lambda (x : \tau_1). e : \tau_1 \to \tau_2 \yields{\lambda x : |\tau_1|. E} $ \\

It follows from \texttt{(TrAbs)} that
  $$ \Gamma, x : \tau_1 \vdash e : \tau_2 \yields{E} $$
And by the induction hypothesis that
  $$ |\Gamma|, x : |\tau_1| \vdash E : |\tau_2| $$
By \texttt{(TrAbs)} we also have
  $$ \Gamma \vdash \tau_1 $$
It follows from Lemma \ref{preserve-wf} that
  $$ |\Gamma| \vdash |\tau_1| $$
Hence by \texttt{(F-Abs)} and the definition of $|\cdot|$ we have
  $$ |\Gamma| \vdash \lambda x : |\tau_1|. E : |\tau_1 \to \tau_2| $$

\texttt{(TrApp)} $ \Gamma \vdash e_1 e_2 : \tau_2 \yields{E_1 (C E_2)} $ \\

From \texttt{(TrApp)} we have
  $$ \Gamma \vdash \tau_3 <: \tau_1 \yields{C} $$
Applying Lemma \ref{type-coerce} to the above we have
  $$ |\Gamma| \vdash C : |\tau_3| \to |\tau_1| $$
Also from \texttt{(TrApp)} and the induction hypothesis
  $$ |\Gamma| \vdash E_1 : |\tau_1| \to |\tau_2| $$
Also from \texttt{(TrApp)} and the induction hypothesis
  $$ |\Gamma| \vdash E_2 : |\tau_3| $$
Assembling those parts using \texttt{(F-App)} we come to
  $$ |\Gamma| \vdash E_1 (C E_2) : |\tau_2| $$
\end{proof}

\texttt{(TrTAbs)} $ \Gamma \vdash \Lambda \alpha. e : \forall \alpha. \tau \yields{\forall \alpha. E} $ \\

From \texttt{(TrTAbs)} we have
  $$ \Gamma \vdash e : \tau \yields{E} $$
By the induction hypothesis we have
  $$ |\Gamma| \vdash E : |\tau| $$
Thus by \texttt{(F-TAbs)} and the definition of $|\cdot|$
  $$ \Gamma \vdash \Lambda \alpha. E : |\forall \alpha. \tau| $$


\texttt{(TrTApp)} $ \Gamma \vdash e \; \tau  : [\alpha := \tau]\tau_1 \yields{E \; |\tau|} $ \\

From \texttt{(TrTApp)} we have
  $$ \Gamma \vdash e : \forall \alpha. \tau_1 \yields{E} $$
And by the induction hypothesis that
  $$ |\Gamma| \vdash E : \forall \alpha. |\tau_1| $$
Also from \texttt{(TrTApp)} and Lemma \ref{preserve-wf} we have
  $$ |\Gamma| \vdash |\tau| $$
Then by \texttt{(F-TApp)} that
  $$ |\Gamma| \vdash E \; |\tau| : [\alpha := |\tau| ]|\tau_1| $$
Therefore
  $$ |\Gamma| \vdash E \; |\tau| : | [\alpha := \tau ] | \tau_1 | | $$

\texttt{(TrMerge)} $ \Gamma \vdash e_1 \merge e_2 : \tau_1 \& \tau_2 \yields{\langle E1, E2  \rangle}$ \\

From \texttt{(TrMerge)} and the induction hypothesis we have
  $$ |\Gamma| \vdash E_1 : |\tau_1| $$
and
  $$ |\Gamma| \vdash E_2 : |\tau_2| $$
Hence by \texttt{(F-Pair)}
  $$ |\Gamma| \vdash \langle E_1, E_2 \rangle : \langle |\tau_1|, |\tau_2| \rangle $$
Hence by the definition of $|\cdot|$
  $$ |\Gamma| \vdash \langle E_1, E_2 \rangle : |\tau_1 \& \tau_2| $$

\texttt{(TrRcdIntro)} $ \Gamma \vdash \{ l = e \} : \{ l : \tau \} \yields{E} $ \\

From \texttt{(TrRcdIntro)} we have
  $$ \Gamma \vdash e : \tau \yields{E} $$
And by the induction hypothesis that
  $$ |\Gamma| \vdash E : |\tau| $$
Thus by the definition of $|\cdot|$
  $$ |\Gamma| \vdash E : |\{ l : \tau \}| $$

\texttt{(TrRcdElim)} $ \Gamma \vdash e.l : \tau_1 \yields{C E} $ \\

From \texttt{(TrRcdElim)}
  $$ \Gamma \vdash e : \tau \yields{E} $$
And by the induction hypothesis that
  $$ |\Gamma| \vdash E : |\tau| $$
Also from \texttt{(TrRcdEim)}
  $$ \Gamma \vdash_{get} e ; l = C ; \tau_1 $$
Applying Lemma \ref{type-get} to the above we have
  $$ |\Gamma| \vdash C : |\tau| \to |\tau_1|  $$
Hence by \texttt{(F-App)} we have
  $$ |\Gamma| \vdash C E : |\tau_1| $$

\texttt{(TrRcdUpd)} $ \Gamma \vdash \rcdupd{e}{l}{e_1} : \tau \yields{C E} $ \\

From \texttt{(TrRcdUpd)}
  $$ \Gamma \vdash e : \tau \yields{E} $$
And by the induction hypothesis that
  $$ |\Gamma| \vdash E : |\tau| $$
Also from \texttt{(TrRcdUpd)}
  $$ \Gamma \vdash_{put} t ; l; E = C ; \tau_1 $$
Applying Lemma \ref{type-put} to the above we have
  $$ |\Gamma| \vdash C : |\tau| \to |\tau|  $$
Hence by \texttt{(F-App)} we have
  $$ |\Gamma| \vdash C E : |\tau| $$

\end{document}
